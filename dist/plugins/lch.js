var t={grad:.9,turn:360,rad:360/(2*Math.PI)},r=function(t){return"string"==typeof t?t.length>0:"number"==typeof t},a=function(t,r,a){return void 0===r&&(r=0),void 0===a&&(a=Math.pow(10,r)),Math.round(a*t)/a+0},n=function(t,r,a){return void 0===r&&(r=0),void 0===a&&(a=1),t>a?a:t>r?t:r},o=function(t){var r=t/255;return r<.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)},c=function(t){return 255*(t>.0031308?1.055*Math.pow(t,1/2.4)-.055:12.92*t)},u=96.422,h=100,e=82.521,i=function(t){var r,a,o={x:.9555766*(r=t).x+-.0230393*r.y+.0631636*r.z,y:-.0282895*r.x+1.0099416*r.y+.0210077*r.z,z:.0122982*r.x+-.020483*r.y+1.3299098*r.z};return a={r:c(.032404542*o.x-.015371385*o.y-.004985314*o.z),g:c(-.00969266*o.x+.018760108*o.y+41556e-8*o.z),b:c(556434e-9*o.x-.002040259*o.y+.010572252*o.z),a:t.a},{r:n(a.r,0,255),g:n(a.g,0,255),b:n(a.b,0,255),a:n(a.a)}},l=function(t){var r=o(t.r),a=o(t.g),c=o(t.b);return function(t){return{x:n(t.x,0,u),y:n(t.y,0,h),z:n(t.z,0,e),a:n(t.a)}}(function(t){return{x:1.0478112*t.x+.0228866*t.y+-.050127*t.z,y:.0295424*t.x+.9904844*t.y+-.0170491*t.z,z:-.0092345*t.x+.0150436*t.y+.7521316*t.z,a:t.a}}({x:100*(.4124564*r+.3575761*a+.1804375*c),y:100*(.2126729*r+.7151522*a+.072175*c),z:100*(.0193339*r+.119192*a+.9503041*c),a:t.a}))},d=216/24389,f=24389/27,v=function(t){return{l:n(t.l,0,100),c:t.c,h:(r=t.h,(r=isFinite(r)?r%360:0)>0?r:r+360),a:t.a};var r},b=function(t,r){return void 0===r&&(r=2),{l:a(t.l,r),c:a(t.c,r),h:a(t.h,r),a:a(t.a,3>r?3:r)}},p=function(t){var a=t.l,n=t.c,o=t.h,c=t.a,u=void 0===c?1:c;if(!r(a)||!r(n)||!r(o))return null;var h=v({l:Number(a),c:Number(n),h:Number(o),a:Number(u)});return M(h)},y=function(t){var r=function(t){var r=l(t),a=r.x/u,n=r.y/h,o=r.z/e;return a=a>d?Math.cbrt(a):(f*a+16)/116,{l:116*(n=n>d?Math.cbrt(n):(f*n+16)/116)-16,a:500*(a-n),b:200*(n-(o=o>d?Math.cbrt(o):(f*o+16)/116)),alpha:r.a}}(t),n=a(r.a,3),o=a(r.b,3),c=Math.atan2(o,n)/Math.PI*180;return{l:r.l,c:Math.sqrt(n*n+o*o),h:c<0?c+360:c,a:r.alpha}},M=function(t){return r={l:t.l,a:t.c*Math.cos(t.h*Math.PI/180),b:t.c*Math.sin(t.h*Math.PI/180),alpha:t.a},n=r.a/500+(a=(r.l+16)/116),o=a-r.b/200,i({x:(Math.pow(n,3)>d?Math.pow(n,3):(116*n-16)/f)*u,y:(r.l>8?Math.pow((r.l+16)/116,3):r.l/f)*h,z:(Math.pow(o,3)>d?Math.pow(o,3):(116*o-16)/f)*e,a:r.alpha});var r,a,n,o},x=/^lch\(\s*([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)\s+([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,s=function(r){var a=x.exec(r);if(!a)return null;var n,o,c=v({l:Number(a[1]),c:Number(a[2]),h:(n=a[3],o=a[4],void 0===o&&(o="deg"),Number(n)*(t[o]||1)),a:void 0===a[5]?1:Number(a[5])/(a[6]?100:1)});return M(c)};module.exports=function(t,r){t.prototype.toLch=function(t){return void 0===t&&(t=2),b(y(this.rgba),t)},t.prototype.toLchString=function(t){return void 0===t&&(t=2),function(t,r){void 0===r&&(r=2);var a=b(y(t),r),n=a.l,o=a.c,c=a.h,u=a.a;return u<1?"lch(".concat(n,"% ").concat(o," ").concat(c," / ").concat(u,")"):"lch(".concat(n,"% ").concat(o," ").concat(c,")")}(this.rgba,t)},r.string.push([s,"lch"]),r.object.push([p,"lch"])};
